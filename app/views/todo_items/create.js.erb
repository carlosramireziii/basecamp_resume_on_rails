var newTodoContainer = document.querySelector("#<%= dom_id(TodoItem.new, dom_id(@todo_list)) %>");

<% if @todo_item.persisted? %>
  var todoList = document.querySelector("#<%= dom_id @todo_list %>");
  var todoItem = document.createElement("div");
  todoItem.innerHTML = "<%= j render(@todo_item) %>";
  todoList.insertBefore(todoItem, todoList.firstChild);

  addButtonHTML = "<%= j render('new_todo_item_button', project: @project, todo_list: @todo_list) %>";
  newTodoContainer.innerHTML = addButtonHTML;
<% else %>
  var formHTML = "<%= j render('new_todo_item', project: @project, todo_list: @todo_list, todo_item: @todo_item) %>";
  newTodoContainer.innerHTML = formHTML;
<% end %>
